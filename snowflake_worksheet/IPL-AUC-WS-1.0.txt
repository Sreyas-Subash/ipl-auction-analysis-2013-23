CREATE WAREHOUSE IF NOT EXISTS "IPL_AUC_13-23"
WAREHOUSE_SIZE = 'XSMALL'
WAREHOUSE_TYPE = 'STANDARD'
AUTO_SUSPEND = 360
AUTO_RESUME = TRUE
;

ALTER WAREHOUSE "IPL_AUC_13-23" RENAME TO IPL_AUCTION_DATA;

USE WAREHOUSE IPL_AUCTION_DATA;


CREATE DATABASE IF NOT EXISTS "IPL_AUC_13-23";

USE DATABASE "IPL_AUC_13-23";

SELECT CURRENT_WAREHOUSE(), current_database(), CURRENT_SCHEMA();

CREATE SCHEMA IF NOT EXISTS IPL_SCHEMA;


SHOW FILE FORMATS IN DATABASE TESTDB;

CREATE FILE FORMAT IF NOT EXISTS IPL_CSV_FORMAT
TYPE = CSV
COMPRESSION = AUTO
RECORD_DELIMITER = '\n'
FIELD_DELIMITER = ','
SKIP_HEADER = 1
DATE_FORMAT = 'YYYY'
NULL_IF = ('NULL');


CREATE OR REPLACE TABLE TEAM(
index NUMBER(4,0),
season VARCHAR(5),
team_name VARCHAR(40),
"REMAINING_FUND(IN RUPEE)" NUMBER(38,0),
overseas_player NUMBER(4,0),
total_players NUMBER(4,0)
);


CREATE OR REPLACE TABLE PLAYER(
index NUMBER(4,0),
season VARCHAR(5),
team_name VARCHAR(50),
player_name VARCHAR(50),
nationality VARCHAR(50),
type VARCHAR(50),
"PRICE_PAID(IN RUPEE)" NUMBER(38,0)
);


SHOW STAGES IN SCHEMA IPL_SCHEMA;
LIST @%TEAM;
-- BECAUSE WE ARE GOING TO USE TABLE STAGE, WE DO NOT NEED TO CREATE STAGE EXPLICITLY

--COPY INTO TEAM FILE_FORMAT = IPL_CSV_FORMAT;
-- FROM CLAUSE CAN BE OMITTED IN TABLE STAGE

-- COPY INTO TEAM FILE_FORMAT = IPL_CSV_FORMAT;


-- CREATE PIPE IF NOT EXISTS PLAYER_PIPE
-- AS COPY INTO TEAM FILE_FORMAT = IPL_CSV_FORMAT;